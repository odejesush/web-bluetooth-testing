<html>

<head>
    <title>Web Bluetooth - Print Device Info</title>
    <script>
        let device = null;
        let gatt = null;

        function setTableData(cellId, data) {
            document.getElementById(cellId).innerText = data;
        }

        function printDeviceInfo() {
            let deviceId = device == null ? "No device connected" : device.id;
            let deviceName = device == null ? "No device connected" : device.name;
            let deviceWatchingAdvertisements = device == null ? "No device connected" : device.watchingAdvertisements;
            setTableData("device-id", deviceId);
            setTableData("device-name", deviceName);
            setTableData("device-watching-advertisements", deviceWatchingAdvertisements);
        }

        function printGattInfo() {
            let gattConnected = gatt == null ? "Not GATT connected" : gatt.connected;
            setTableData("gatt-connected", gattConnected);
        }

        function refreshInfo() {
            printDeviceInfo();
            printGattInfo();
        }

        async function connectDevice() {
            device = await navigator.bluetooth.requestDevice({ acceptAllDevices: true });
            printDeviceInfo();
            gatt = await device.gatt.connect();
            printGattInfo();
        }
    </script>
</head>

<body onload="refreshInfo()">
    <h1>Print Web Bluetooth device info</h1>
    <input type="button" onclick="connectDevice()" value="Connect To Device" />
    <input type="button" onclick="refreshInfo()" value="Refresh Info" />
    <a href="index.html">back</a>
    <div>
        <h2>Device Info</h2>
        <table>
            <tr>
                <td>Device ID</td>
                <td id="device-id"></td>
            </tr>
            <tr>
                <td>Device Name</td>
                <td id="device-name"></td>
            </tr>
            <tr>
                <td>Is watching advertisements?</td>
                <td id="device-watching-advertisements"></td>
            </tr>
        </table>
    </div>
    <div id="gatt-info">
        <h2>GATT Info</h2> 
        <table>
            <tr>
                <td>Is connected?</td>
                <td id="gatt-connected"></td>
            </tr>
        </table>
    </div>
</body>

</html>